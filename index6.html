<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SV STORES | Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --royal-blue: #1A2238; --premium-gold: #D4AF37; }
        .bg-royal { background-color: var(--royal-blue); }
        .text-gold { color: var(--premium-gold); }
        .bg-gold { background-color: var(--premium-gold); }
        .hide { display: none !important; }
        .mode-active { border-bottom: 4px solid var(--premium-gold); color: var(--premium-gold); background-color: rgba(212, 175, 55, 0.1); }
        #side-drawer { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .drawer-open { transform: translateX(0) !important; }
        .drawer-closed { transform: translateX(-100%); }
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1000; transition: all 0.5s ease; opacity: 0; }
        .toast-show { opacity: 1 !important; top: 30px !important; }
        .btn-premium { border: 1px solid rgba(212, 175, 55, 0.3); transition: all 0.3s; }
        .btn-premium:active { scale: 0.95; }
    </style>
</head>
<body class="bg-[#F4F4F4] font-sans h-screen flex flex-col overflow-hidden text-gray-800">

    <div id="toast" class="bg-royal border border-gold text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-2">
        <i class="fa-solid fa-circle-check text-gold"></i> <span class="font-bold">Item Added to Cart!</span>
    </div>

    <div id="login-view" class="fixed inset-0 bg-royal z-[100] flex flex-col justify-center px-8 overflow-y-auto">
        <div class="text-center mb-8">
            <h1 class="text-5xl font-serif text-gold tracking-widest mb-2">SV STORES</h1>
            <div class="h-1 w-20 bg-gold mx-auto rounded-full"></div>
        </div>

        <div id="login-choice" class="space-y-4">
            <button onclick="showLoginForm('new')" class="w-full bg-gold text-royal py-5 rounded-2xl font-black text-lg shadow-lg btn-premium">
                <i class="fa-solid fa-user-plus mr-2"></i> NEW USER
            </button>
            <button onclick="showLoginForm('existing')" class="w-full bg-white/10 text-gold py-5 rounded-2xl font-black text-lg border border-gold/30 btn-premium">
                <i class="fa-solid fa-user-check mr-2"></i> EXISTING USER
            </button>
        </div>

        <div id="login-form" class="hide bg-white/10 backdrop-blur-md p-8 rounded-3xl border border-white/20 space-y-4 mt-4">
            <h3 id="form-title" class="text-gold text-center font-bold uppercase tracking-widest mb-2">Details</h3>
            
            <div id="name-group">
                <input type="text" id="inpName" placeholder="Full Name" class="w-full p-4 rounded-xl bg-white/5 border border-white/10 text-white placeholder-gray-400 focus:border-gold outline-none">
            </div>
            
            <input type="tel" id="inpPhone" placeholder="Mobile Number" class="w-full p-4 rounded-xl bg-white/5 border border-white/10 text-white placeholder-gray-400 focus:border-gold outline-none">
            
            <div id="loc-group">
                <input type="text" id="inpLoc" placeholder="Location (Village/City)" class="w-full p-4 rounded-xl bg-white/5 border border-white/10 text-white placeholder-gray-400 focus:border-gold outline-none">
            </div>
            
            <button onclick="processLogin()" class="w-full bg-gold text-royal py-4 rounded-xl font-black text-lg shadow-lg hover:brightness-110 transition uppercase">
                Enter Store
            </button>
            <button onclick="backToChoice()" class="w-full text-gray-400 text-xs font-bold uppercase tracking-widest mt-2">‚Üê Back</button>
            <p id="login-error" class="text-red-400 text-xs text-center font-bold hide">Please fill all fields correctly.</p>
        </div>
    </div>

    <div id="drawer-overlay" onclick="toggleDrawer()" class="fixed inset-0 bg-black/70 z-[60] hide backdrop-blur-sm"></div>
    <aside id="side-drawer" class="fixed top-0 left-0 h-full w-72 bg-royal z-[70] shadow-2xl drawer-closed flex flex-col border-r border-gold/20">
        <div class="p-8 text-white border-b border-gold/20">
            <div class="w-16 h-16 border-2 border-gold rounded-full flex items-center justify-center text-2xl mb-4 bg-white/5">
                <i class="fa-solid fa-user text-gold"></i>
            </div>
            <h2 id="drawer-name" class="text-xl font-serif">Guest</h2>
            <p id="drawer-phone" class="text-xs text-gray-400">+91 00000 00000</p>
            <p id="drawer-loc" class="text-[10px] text-gold mt-2 font-bold uppercase"><i class="fa-solid fa-location-dot mr-1"></i> Location</p>
        </div>
        <div class="p-4 flex-1 space-y-2">
            <div onclick="toggleDrawer(); navTo('home')" class="flex items-center gap-4 p-4 text-white hover:bg-gold/10 rounded-xl cursor-pointer">
                <i class="fa-solid fa-house text-gold"></i> <span>Home</span>
            </div>
            <div onclick="toggleDrawer(); navTo('cart')" class="flex items-center gap-4 p-4 text-white hover:bg-gold/10 rounded-xl cursor-pointer">
                <i class="fa-solid fa-bag-shopping text-gold"></i> <span>My Cart</span>
            </div>
            <div onclick="window.open('https://wa.me/9618622559')" class="flex items-center gap-4 p-4 text-white hover:bg-gold/10 rounded-xl cursor-pointer">
                <i class="fa-solid fa-headset text-gold"></i> <span>Customer Care</span>
            </div>
        </div>
        <button onclick="logout()" class="m-4 p-4 text-red-400 font-bold border border-red-400/20 rounded-xl">LOGOUT</button>
    </aside>

    <header id="main-header" class="hide bg-royal shadow-2xl z-50 flex-none sticky top-0">
        <div class="p-4 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <button onclick="toggleDrawer()" class="text-gold text-2xl"><i class="fa-solid fa-bars-staggered"></i></button>
                <span class="font-serif text-2xl text-gold tracking-tighter">SV STORES</span>
            </div>
            <div onclick="navTo('cart')" class="relative bg-white/5 p-3 rounded-full border border-white/10 text-gold">
                <i class="fa-solid fa-cart-shopping"></i>
                <span id="header-cart-badge" class="hide absolute -top-1 -right-1 bg-gold text-royal text-[10px] font-black w-5 h-5 flex items-center justify-center rounded-full border-2 border-royal">0</span>
            </div>
        </div>
        <div class="flex bg-royal border-t border-white/5">
            <button onclick="switchMode('broom')" id="btn-broom" class="flex-1 py-4 text-[10px] font-black uppercase tracking-widest mode-active">Broom Factory</button>
            <button onclick="switchMode('general')" id="btn-general" class="flex-1 py-4 text-[10px] font-black uppercase tracking-widest text-gray-500">General Store</button>
        </div>
    </header>

    <main id="content-area" class="hide flex-1 overflow-y-auto pb-10">
        <div id="home-view" class="p-3">
            <div id="product-grid" class="grid grid-cols-2 gap-3 pb-24 mt-4"></div>
        </div>
        <div id="cart-view" class="hide p-4 min-h-full pb-40">
            <h2 class="text-3xl font-serif text-royal mb-6">Your Selection</h2>
            <div id="cart-list" class="space-y-4"></div>
            <div id="empty-cart" class="text-center py-20 opacity-30"><p class="text-xl font-bold">Cart is empty</p></div>
        </div>
    </main>

    <div id="checkout-bar" class="hide fixed bottom-0 left-0 w-full bg-royal p-6 z-50 rounded-t-[2.5rem] border-t border-gold/30">
        <div class="flex justify-between items-center mb-5">
            <div><p class="text-[10px] text-gray-400 uppercase">Total</p><h3 id="total-price" class="text-3xl font-serif text-gold">‚Çπ0</h3></div>
            <div class="text-gold font-black">Items: <span id="total-items-count">0</span></div>
        </div>
        <button onclick="placeOrder()" class="w-full bg-gold text-royal py-5 rounded-2xl font-black text-lg flex justify-center items-center gap-3">
            <i class="fa-brands fa-whatsapp text-2xl"></i> CONFIRM ORDER
        </button>
    </div>

    <script>
        const WHATSAPP_NUMBER = "9618622559";
        let currentUser = { name: "", phone: "", loc: "" };
        let loginType = 'new';
        let cart = [];

        function showLoginForm(type) {
            loginType = type;
            document.getElementById('login-choice').classList.add('hide');
            document.getElementById('login-form').classList.remove('hide');
            document.getElementById('form-title').innerText = type === 'new' ? 'Create New Account' : 'Welcome Back';
            
            if(type === 'existing') {
                document.getElementById('name-group').classList.add('hide');
                document.getElementById('loc-group').classList.add('hide');
            } else {
                document.getElementById('name-group').classList.remove('hide');
                document.getElementById('loc-group').classList.remove('hide');
            }
        }

        function backToChoice() {
            document.getElementById('login-choice').classList.remove('hide');
            document.getElementById('login-form').classList.add('hide');
        }

        function processLogin() {
            const n = document.getElementById('inpName').value;
            const p = document.getElementById('inpPhone').value;
            const l = document.getElementById('inpLoc').value;

            if(loginType === 'new') {
                if(n.length < 3 || p.length < 10 || l.length < 3) {
                    document.getElementById('login-error').classList.remove('hide');
                    return;
                }
                currentUser = { name: n, phone: p, loc: l };
            } else {
                if(p.length < 10) {
                    document.getElementById('login-error').classList.remove('hide');
                    return;
                }
                // For existing user, check if we have them in local storage or just use phone
                const saved = localStorage.getItem('svUser');
                if(saved && JSON.parse(saved).phone === p) {
                    currentUser = JSON.parse(saved);
                } else {
                    currentUser = { name: "Valued Customer", phone: p, loc: "Unknown" };
                }
            }
            
            localStorage.setItem('svUser', JSON.stringify(currentUser));
            enterApp();
        }

        function enterApp() {
            document.getElementById('drawer-name').innerText = currentUser.name;
            document.getElementById('drawer-phone').innerText = "+91 " + currentUser.phone;
            document.getElementById('drawer-loc').innerText = currentUser.loc;
            document.getElementById('login-view').classList.add('hide');
            document.getElementById('main-header').classList.remove('hide');
            document.getElementById('content-area').classList.remove('hide');
            renderGrid(broomItems);
        }

        const broomItems = [
            { id: 1, name: "Polyking Sutli (Heavy)", price: 185, img: "https://images.unsplash.com/photo-1605881528191-68f38c78e3d3?w=300" },
            { id: 2, name: "Bansal Steel Wire 22G", price: 83, img: "https://images.unsplash.com/photo-1621259182978-fbf93132d53d?w=300" }
        ];

        function switchMode(mode) {
            document.getElementById('btn-broom').className = mode==='broom'?'flex-1 py-4 text-[10px] font-black uppercase tracking-widest mode-active':'flex-1 py-4 text-[10px] font-black uppercase tracking-widest text-gray-500';
            document.getElementById('btn-general').className = mode==='general'?'flex-1 py-4 text-[10px] font-black uppercase tracking-widest mode-active':'flex-1 py-4 text-[10px] font-black uppercase tracking-widest text-gray-500';
            renderGrid(mode === 'broom' ? broomItems : []);
        }

        function renderGrid(items) {
            document.getElementById('product-grid').innerHTML = items.map(p => `
                <div class="bg-white rounded-3xl p-3 shadow-lg border border-gray-100">
                    <img src="${p.img}" class="h-24 mx-auto mb-2 object-contain">
                    <p class="text-[11px] font-bold h-8 line-clamp-2 text-royal">${p.name}</p>
                    <div class="flex justify-between items-center mt-3">
                        <span class="text-sm font-black text-royal">‚Çπ${p.price}</span>
                        <button onclick="addToCart(${p.id})" class="bg-royal text-gold w-8 h-8 rounded-xl flex items-center justify-center shadow-lg">+</button>
                    </div>
                </div>`).join('');
        }

        function addToCart(id) {
            let item = broomItems.find(x => x.id === id);
            let ex = cart.find(x => x.id === id);
            if(ex) ex.qty++; else cart.push({...item, qty: 1});
            updateCartUI();
            showToast();
        }

        function updateCartUI() {
            const totalQty = cart.reduce((a,b) => a + b.qty, 0);
            const badge = document.getElementById('header-cart-badge');
            badge.innerText = totalQty;
            totalQty > 0 ? badge.classList.remove('hide') : badge.classList.add('hide');
            document.getElementById('total-price').innerText = "‚Çπ" + cart.reduce((a,b) => a + (b.qty * b.price), 0);
            document.getElementById('total-items-count').innerText = totalQty;
        }

        function navTo(page) {
            document.getElementById('home-view').classList.add('hide');
            document.getElementById('cart-view').classList.add('hide');
            document.getElementById(page + '-view').classList.remove('hide');
            if(page === 'cart') { renderCartPage(); document.getElementById('checkout-bar').classList.remove('hide'); }
            else { document.getElementById('checkout-bar').classList.add('hide'); }
        }

        function renderCartPage() {
            const list = document.getElementById('cart-list');
            if(cart.length === 0) { list.innerHTML = ''; document.getElementById('empty-cart').classList.remove('hide'); return; }
            document.getElementById('empty-cart').classList.add('hide');
            list.innerHTML = cart.map(i => `<div class="bg-white p-4 rounded-3xl shadow-md flex justify-between"><div>${i.name}</div><div class="font-bold">‚Çπ${i.price * i.qty}</div></div>`).join('');
        }

        function showToast() {
            const t = document.getElementById('toast');
            t.classList.add('toast-show');
            setTimeout(() => t.classList.remove('toast-show'), 2000);
        }

        function toggleDrawer() {
            const d = document.getElementById('side-drawer');
            const o = document.getElementById('drawer-overlay');
            d.classList.toggle('drawer-closed'); d.classList.toggle('drawer-open');
            o.classList.toggle('hide');
        }

        function logout() { localStorage.removeItem('svUser'); location.reload(); }

        function placeOrder() {
            let msg = `üëë *ORDER - SV STORES*\nüë§ ${currentUser.name}\nüì± ${currentUser.phone}\n-------------------\n`;
            cart.forEach(i => msg += `‚Ä¢ ${i.name} x ${i.qty}\n`);
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank');
        }
    </script>
</body>
</html>
